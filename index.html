<!DOCTYPE html>
<html lang="es">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Demo Loyalty - Casos de uso reales</title>
      <style>
         * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
         }
         body {
         font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
         background: #f5f5f5;
         min-height: 100vh;
         }
         /* ============================================
         BARRA DE NAVEGACI√ìN
         ============================================ */
         .navbar {
         background: linear-gradient(135deg, #2D4FD7 0%, #764ba2 100%);
         padding: 0;
         box-shadow: 0 2px 10px rgba(0,0,0,0.1);
         position: sticky;
         top: 0;
         z-index: 1000;
         }
         .nav-container {
         max-width: 1200px;
         margin: 0 auto;
         display: flex;
         justify-content: space-between;
         align-items: center;
         padding: 0 20px;
         }
         .nav-logo {
         color: white;
         font-size: 24px;
         font-weight: bold;
         padding: 20px 0;
         text-decoration: none;
         }
         .nav-menu {
         display: flex;
         list-style: none;
         gap: 0;
         }
         .nav-item {
         position: relative;
         }
         .nav-link {
         color: white;
         text-decoration: none;
         padding: 25px 25px;
         display: block;
         font-weight: 500;
         transition: background 0.3s;
         border-bottom: 3px solid transparent;
         }
         .nav-link:hover,
         .nav-link.active {
         background: rgba(255,255,255,0.1);
         border-bottom-color: white;
         }
         /* Hamburger menu para m√≥vil */
         .nav-toggle {
         display: none;
         flex-direction: column;
         cursor: pointer;
         padding: 10px;
         }
         .nav-toggle span {
         width: 25px;
         height: 3px;
         background: white;
         margin: 3px 0;
         transition: 0.3s;
         }
         /* ============================================
         CONTENEDOR PRINCIPAL
         ============================================ */
         .main-container {
         max-width: 1200px;
         margin: 0 auto;
         padding: 40px 20px;
         }
         .section {
         display: none;
         background: white;
         border-radius: 10px;
         box-shadow: 0 5px 20px rgba(0,0,0,0.1);
         padding: 40px;
         animation: fadeIn 0.5s;
         }
         .section.active {
         display: block;
         }
         @keyframes fadeIn {
         from { opacity: 0; transform: translateY(20px); }
         to { opacity: 1; transform: translateY(0); }
         }
         h1 {
         color: #333;
         margin-bottom: 10px;
         font-size: 32px;
         }
         .subtitle {
         color: #666;
         margin-bottom: 30px;
         font-size: 16px;
         }
         /* ============================================
         HOME SECTION
         ============================================ */
         .hero {
         text-align: center;
         padding: 60px 20px;
         }
         .hero h1 {
         font-size: 48px;
         margin-bottom: 20px;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         -webkit-background-clip: text;
         -webkit-text-fill-color: transparent;
         background-clip: text;
         }
         .hero p {
         font-size: 20px;
         color: #666;
         margin-bottom: 40px;
         }
         .benefits-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
         gap: 30px;
         margin-top: 50px;
         }
         .benefit-card {
         text-align: center;
         padding: 30px;
         border-radius: 10px;
         background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
         transition: transform 0.3s;
         }
         .benefit-card:hover {
         transform: translateY(-10px);
         }
         .benefit-icon {
         font-size: 48px;
         margin-bottom: 20px;
         }
         .benefit-card h3 {
         color: #333;
         margin-bottom: 10px;
         }
         .benefit-card p {
         color: #666;
         font-size: 14px;
         }
         /* ============================================
         FORMULARIO (ALTA)
         ============================================ */
         .form-group {
         margin-bottom: 20px;
         }
         label {
         display: block;
         color: #333;
         font-weight: 600;
         margin-bottom: 8px;
         font-size: 14px;
         }
         .required {
         color: #e74c3c;
         }
         input, select, textarea {
         width: 100%;
         padding: 12px;
         border: 2px solid #e0e0e0;
         border-radius: 5px;
         font-size: 14px;
         transition: border-color 0.3s;
         font-family: inherit;
         }
         input:focus, select:focus, textarea:focus {
         outline: none;
         border-color: #667eea;
         }
         .form-row {
         display: grid;
         grid-template-columns: 1fr 1fr;
         gap: 20px;
         }
         .btn {
         padding: 14px 30px;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         color: white;
         border: none;
         border-radius: 5px;
         font-size: 16px;
         font-weight: 600;
         cursor: pointer;
         transition: transform 0.2s;
         }
         .btn:hover {
         transform: translateY(-2px);
         box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
         }
         .btn:disabled {
         background: #ccc;
         cursor: not-allowed;
         transform: none;
         }
         .btn-secondary {
         background: #6c757d;
         margin-left: 10px;
         }
         .btn-secondary:hover {
         box-shadow: 0 5px 20px rgba(108, 117, 125, 0.4);
         }
         /* ============================================
         COMPRAR (PRODUCTOS)
         ============================================ */
         .products-grid {
         display: grid;
         grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
         gap: 30px;
         margin-top: 30px;
         }
         .product-card {
         border: 2px solid #e0e0e0;
         border-radius: 10px;
         overflow: hidden;
         transition: transform 0.3s, box-shadow 0.3s;
         }
         .product-card:hover {
         transform: translateY(-5px);
         box-shadow: 0 10px 30px rgba(0,0,0,0.15);
         }
         .product-image {
         width: 100%;
         height: 200px;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         display: flex;
         align-items: center;
         justify-content: center;
         font-size: 64px;
         color: white;
         }
         .product-info {
         padding: 20px;
         }
         .product-title {
         font-size: 18px;
         font-weight: 600;
         color: #333;
         margin-bottom: 10px;
         }
         .product-description {
         color: #666;
         font-size: 14px;
         margin-bottom: 15px;
         line-height: 1.5;
         }
         .product-price {
         display: flex;
         justify-content: space-between;
         align-items: center;
         margin-bottom: 15px;
         }
         .price {
         font-size: 24px;
         font-weight: bold;
         color: #667eea;
         }
         .points {
         font-size: 14px;
         color: #764ba2;
         font-weight: 600;
         }
         /* ============================================
         CONSULTAR PERFIL
         ============================================ */
         .profile-search {
         margin-bottom: 30px;
         display: flex;
         gap: 10px;
         }
         .profile-search input {
         flex: 1;
         }
         .profile-card {
         display: none;
         border: 2px solid #e0e0e0;
         border-radius: 10px;
         padding: 30px;
         margin-top: 30px;
         }
         .profile-card.show {
         display: block;
         animation: fadeIn 0.5s;
         }
         .profile-header {
         display: flex;
         align-items: center;
         gap: 20px;
         margin-bottom: 30px;
         padding-bottom: 20px;
         border-bottom: 2px solid #e0e0e0;
         }
         .profile-avatar {
         width: 80px;
         height: 80px;
         border-radius: 50%;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         display: flex;
         align-items: center;
         justify-content: center;
         color: white;
         font-size: 32px;
         font-weight: bold;
         }
         .profile-name {
         flex: 1;
         }
         .profile-name h2 {
         color: #333;
         margin-bottom: 5px;
         }
         .profile-tier {
         display: inline-block;
         padding: 5px 15px;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         color: white;
         border-radius: 20px;
         font-size: 14px;
         font-weight: 600;
         }
         .profile-stats {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
         gap: 20px;
         margin-bottom: 30px;
         }
         .stat-card {
         text-align: center;
         padding: 20px;
         background: #f8f9fa;
         border-radius: 10px;
         }
         .stat-value {
         font-size: 32px;
         font-weight: bold;
         color: #667eea;
         margin-bottom: 5px;
         }
         .stat-label {
         color: #666;
         font-size: 14px;
         }
         .profile-details {
         display: grid;
         grid-template-columns: 1fr 1fr;
         gap: 20px;
         }
         .detail-item {
         padding: 15px;
         background: #f8f9fa;
         border-radius: 5px;
         }
         .detail-label {
         font-size: 12px;
         color: #666;
         text-transform: uppercase;
         margin-bottom: 5px;
         }
         .detail-value {
         font-size: 16px;
         color: #333;
         font-weight: 600;
         }
         /* Animaci√≥n para tarjetas de moneda */
         .currency-card {
         animation: slideIn 0.5s ease-out forwards;
         opacity: 0;
         }
         @keyframes slideIn {
         from {
         opacity: 0;
         transform: translateY(20px);
         }
         to {
         opacity: 1;
         transform: translateY(0);
         }
         }
         /* Colores alternativos para cada moneda */
         .currency-card:nth-child(1) .stat-value {
         color: #667eea;
         }
         .currency-card:nth-child(2) .stat-value {
         color: #764ba2;
         }
         .currency-card:nth-child(3) .stat-value {
         color: #f093fb;
         }
         .currency-card:nth-child(4) .stat-value {
         color: #4facfe;
         }
         /* ============================================
         SPIN THE WHEEL
         ============================================ */
         .wheel-container {
         text-align: center;
         max-width: 600px;
         margin: 0 auto;
         }
         .wheel-login {
         max-width: 400px;
         margin: 50px auto;
         }
         .wheel-game {
         display: none;
         }
         .wheel-game.active {
         display: block;
         }
         .wheel-wrapper {
         position: relative;
         width: 400px;
         height: 400px;
         margin: 40px auto;
         }
         .wheel {
         width: 100%;
         height: 100%;
         border-radius: 50%;
         border: 10px solid #667eea;
         position: relative;
         overflow: hidden;
         transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
         box-shadow: 0 10px 40px rgba(0,0,0,0.3);
         }
         .wheel-segment {
         position: absolute;
         width: 50%;
         height: 50%;
         transform-origin: 100% 100%;
         clip-path: polygon(0 0, 100% 0, 100% 100%);
         display: flex;
         align-items: center;
         justify-content: center;
         }
         .wheel-segment span {
         position: absolute;
         left: 60%;
         top: 30%;
         transform: rotate(22.5deg);
         color: white;
         font-weight: bold;
         font-size: 14px;
         text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
         }
         .wheel-pointer {
         position: absolute;
         top: -20px;
         left: 50%;
         transform: translateX(-50%);
         width: 0;
         height: 0;
         border-left: 20px solid transparent;
         border-right: 20px solid transparent;
         border-top: 40px solid #e74c3c;
         z-index: 10;
         filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
         }
         .wheel-center {
         position: absolute;
         top: 50%;
         left: 50%;
         transform: translate(-50%, -50%);
         width: 80px;
         height: 80px;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         border-radius: 50%;
         border: 5px solid white;
         z-index: 5;
         box-shadow: 0 4px 10px rgba(0,0,0,0.3);
         }
         .spin-button {
         margin-top: 30px;
         padding: 20px 50px;
         font-size: 20px;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         color: white;
         border: none;
         border-radius: 50px;
         cursor: pointer;
         transition: all 0.3s;
         box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
         }
         .spin-button:hover:not(:disabled) {
         transform: translateY(-3px);
         box-shadow: 0 8px 30px rgba(102, 126, 234, 0.6);
         }
         .spin-button:disabled {
         background: #ccc;
         cursor: not-allowed;
         transform: none;
         }
         .wheel-result {
         margin-top: 30px;
         padding: 20px;
         background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
         border-radius: 10px;
         display: none;
         }
         .wheel-result.show {
         display: block;
         animation: fadeIn 0.5s;
         }
         .wheel-result h3 {
         color: #155724;
         margin-bottom: 10px;
         }
         .wheel-result p {
         color: #155724;
         font-size: 18px;
         font-weight: 600;
         }
         .wheel-info {
         background: #e3f2fd;
         padding: 20px;
         border-radius: 10px;
         margin-bottom: 30px;
         }
         .wheel-info h3 {
         color: #1976d2;
         margin-bottom: 10px;
         }
         .wheel-info ul {
         list-style: none;
         padding-left: 0;
         }
         .wheel-info li {
         color: #1976d2;
         padding: 5px 0;
         padding-left: 25px;
         position: relative;
         }
         .wheel-info li:before {
         content: "üéÅ";
         position: absolute;
         left: 0;
         }
         /* ============================================
         MENSAJES Y LOADING
         ============================================ */
         .message {
         margin-top: 20px;
         padding: 12px;
         border-radius: 5px;
         display: none;
         }
         .message.success {
         background: #d4edda;
         color: #155724;
         border: 1px solid #c3e6cb;
         }
         .message.error {
         background: #f8d7da;
         color: #721c24;
         border: 1px solid #f5c6cb;
         }
         .message.show {
         display: block;
         animation: fadeIn 0.5s;
         }
         .loading {
         display: none;
         text-align: center;
         margin-top: 20px;
         }
         .loading.show {
         display: block;
         }
         .spinner {
         border: 3px solid #f3f3f3;
         border-top: 3px solid #667eea;
         border-radius: 50%;
         width: 40px;
         height: 40px;
         animation: spin 1s linear infinite;
         margin: 0 auto 10px;
         }
         @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
         }
         /* ============================================
         RESPONSIVE
         ============================================ */
         @media (max-width: 768px) {
         .nav-menu {
         display: none;
         flex-direction: column;
         position: absolute;
         top: 100%;
         left: 0;
         width: 100%;
         background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
         }
         .nav-menu.active {
         display: flex;
         }
         .nav-toggle {
         display: flex;
         }
         .form-row,
         .profile-details {
         grid-template-columns: 1fr;
         }
         .hero h1 {
         font-size: 32px;
         }
         .section {
         padding: 20px;
         }
         .wheel-wrapper {
         width: 300px;
         height: 300px;
         }
         .wheel-center {
         width: 60px;
         height: 60px;
         }
         }
      </style>
   </head>
   <body>
      <!-- ============================================
         BARRA DE NAVEGACI√ìN
         ============================================ -->
      <nav class="navbar">
         <div class="nav-container">
            <a href="#" class="nav-logo" onclick="showSection('home')">üèÜ Demo Loyalty</a>
            <div class="nav-toggle" id="navToggle">
               <span></span>
               <span></span>
               <span></span>
            </div>
            <ul class="nav-menu" id="navMenu">
               <li class="nav-item">
                  <a href="#" class="nav-link active" data-section="home" onclick="showSection('home')">Home</a>
               </li>
               <li class="nav-item">
                  <a href="#" class="nav-link" data-section="alta" onclick="showSection('alta')">Alta</a>
               </li>
               <li class="nav-item">
                  <a href="#" class="nav-link" data-section="comprar" onclick="showSection('comprar')">Comprar</a>
               </li>
               <li class="nav-item">
                  <a href="#" class="nav-link" data-section="rueda" onclick="showSection('rueda')">Prueba tu Suerte</a>
               </li>
               <li class="nav-item">
                  <a href="#" class="nav-link" data-section="perfil" onclick="showSection('perfil')">Consultar Perfil</a>
               </li>
            </ul>
         </div>
      </nav>
      <!-- ============================================
         CONTENIDO PRINCIPAL
         ============================================ -->
      <div class="main-container">
         <!-- SECCI√ìN HOME -->
         <section id="home" class="section active">
            <div class="hero">
               <h1>Bienvenido a Demo Loyalty</h1>
               <p>Tu programa de fidelizaci√≥n con beneficios exclusivos</p>
               <button class="btn" onclick="showSection('alta')">√önete Ahora</button>
               <button class="btn btn-secondary" onclick="showSection('perfil')">Consultar Puntos</button>
            </div>
            <div class="benefits-grid">
               <div class="benefit-card">
                  <div class="benefit-icon">üéÅ</div>
                  <h3>Recompensas Exclusivas</h3>
                  <p>Accede a productos y servicios premium con tus puntos acumulados</p>
               </div>
               <div class="benefit-card">
                  <div class="benefit-icon">‚≠ê</div>
                  <h3>Niveles VIP</h3>
                  <p>Sube de nivel y desbloquea beneficios cada vez m√°s exclusivos</p>
               </div>
               <div class="benefit-card">
                  <div class="benefit-icon">üè®</div>
                  <h3>Descuentos en Hoteles</h3>
                  <p>Disfruta de tarifas especiales en nuestra red de servicios</p>
               </div>
               <div class="benefit-card">
                  <div class="benefit-icon">‚úàÔ∏è</div>
                  <h3>Viajes Premium</h3>
                  <p>Canje tus puntos por experiencias de viaje inolvidables</p>
               </div>
            </div>
         </section>
         <!-- SECCI√ìN ALTA (REGISTRO) -->
         <section id="alta" class="section">
            <h1>Registro de Nuevo Miembro</h1>
            <p class="subtitle">Completa el formulario para unirte a nuestro programa</p>
            <form id="loyaltyForm">
               <div class="form-row">
                  <div class="form-group">
                     <label for="firstName">Nombre <span class="required">*</span></label>
                     <input type="text" id="firstName" name="firstName" required>
                  </div>
                  <div class="form-group">
                     <label for="lastName">Apellidos <span class="required">*</span></label>
                     <input type="text" id="lastName" name="lastName" required>
                  </div>
               </div>
               <div class="form-row">
                  <div class="form-group">
                     <label for="email">Email <span class="required">*</span></label>
                     <input type="email" id="email" name="email" required>
                  </div>
                  <div class="form-group">
                     <label for="phone">Tel√©fono</label>
                     <input type="tel" id="phone" name="phone">
                  </div>
               </div>
               <div class="form-row">
                  <div class="form-group">
                     <label for="birthDate">Fecha de Nacimiento</label>
                     <input type="date" id="birthDate" name="birthDate">
                  </div>
                  <div class="form-group">
                     <label for="enrollmentChannel">Canal de Registro <span class="required">*</span></label>
                     <select id="enrollmentChannel" name="enrollmentChannel" required>
                        <option value="">Seleccione...</option>
                        <option value="Web">Web</option>
                        <option value="Mobile App">Mobile App</option>
                        <option value="Call Center">Call Center</option>
                     </select>
                  </div>
               </div>
               <div class="form-group">
                  <label for="membershipNumber">N√∫mero de Membres√≠a</label>
                  <input type="text" id="membershipNumber" name="membershipNumber" placeholder="Se generar√° autom√°ticamente" readonly>
               </div>
               <button type="submit" class="btn" id="submitBtn">Registrarse</button>
               <button type="reset" class="btn btn-secondary">Limpiar</button>
            </form>
            <div class="loading" id="loading">
               <div class="spinner"></div>
               <p>Procesando registro...</p>
            </div>
            <div class="message" id="message"></div>
         </section>
         <!-- SECCI√ìN COMPRAR -->
         <section id="comprar" class="section">
            <h1>Tienda de Recompensas</h1>
            <p class="subtitle">Canjea tus puntos por productos exclusivos</p>
            <div class="products-grid">
               <div class="product-card">
                  <div class="product-image">üè®</div>
                  <div class="product-info">
                     <div class="product-title">Dia piscina gratis</div>
                     <div class="product-description">
                        Un dia de piscina gratis en nuestras instalaciones
                     </div>
                     <div class="product-price">
                        <span class="price">‚Ç¨150</span>
                        <span class="points">15,000 pts</span>
                     </div>
                     <button class="btn" onclick="buyProduct('Dia playa gratis', 150)">Canjear</button>
                  </div>
               </div>
               <div class="product-card">
                  <div class="product-image">üçΩÔ∏è</div>
                  <div class="product-info">
                     <div class="product-title">Cena Gourmet</div>
                     <div class="product-description">
                        Experiencia gastron√≥mica para 2 personas en restaurante premium
                     </div>
                     <div class="product-price">
                        <span class="price">‚Ç¨80</span>
                        <span class="points">8,000 pts</span>
                     </div>
                     <button class="btn" onclick="buyProduct('Cena Gourmet', 80)">Canjear</button>
                  </div>
               </div>
               <div class="product-card">
                  <div class="product-image">üíÜ</div>
                  <div class="product-info">
                     <div class="product-title">Spa Premium</div>
                     <div class="product-description">
                        D√≠a completo de spa con masajes y tratamientos de lujo
                     </div>
                     <div class="product-price">
                        <span class="price">‚Ç¨120</span>
                        <span class="points">12,000 pts</span>
                     </div>
                     <button class="btn" onclick="buyProduct('Spa Premium', 120)">Canjear</button>
                  </div>
               </div>
               <div class="product-card">
                  <div class="product-image">‚úàÔ∏è</div>
                  <div class="product-info">
                     <div class="product-title">Upgrade de Vuelo</div>
                     <div class="product-description">
                        Mejora tu asiento a clase business en tu pr√≥ximo vuelo
                     </div>
                     <div class="product-price">
                        <span class="price">‚Ç¨200</span>
                        <span class="points">20,000 pts</span>
                     </div>
                     <button class="btn" onclick="buyProduct('Upgrade Vuelo', 200)">Canjear</button>
                  </div>
               </div>
               <div class="product-card">
                  <div class="product-image">üé´</div>
                  <div class="product-info">
                     <div class="product-title">Entradas VIP</div>
                     <div class="product-description">
                        Acceso exclusivo a eventos y espect√°culos premium
                     </div>
                     <div class="product-price">
                        <span class="price">‚Ç¨100</span>
                        <span class="points">10,000 pts</span>
                     </div>
                     <button class="btn" onclick="buyProduct('Entradas VIP', 100)">Canjear</button>
                  </div>
               </div>
               <div class="product-card">
                  <div class="product-image">üéÅ</div>
                  <div class="product-info">
                     <div class="product-title">Tarjeta Regalo</div>
                     <div class="product-description">
                        Tarjeta regalo de ‚Ç¨50 para usar en cualquier servicio
                     </div>
                     <div class="product-price">
                        <span class="price">‚Ç¨50</span>
                        <span class="points">5,000 pts</span>
                     </div>
                     <button class="btn" onclick="buyProduct('Tarjeta Regalo', 50)">Canjear</button>
                  </div>
               </div>
            </div>
         </section>
         <!-- SECCI√ìN SPIN THE WHEEL -->
         <section id="rueda" class="section">
            <div class="wheel-container">
               <h1>üé∞ Prueba tu Suerte</h1>
               <p class="subtitle">¬°Gira la ruleta y gana premios incre√≠bles!</p>
               <!-- Login de la Ruleta -->
               <div class="wheel-login" id="wheelLogin">
                  <div class="form-group">
                     <label for="wheelMembershipNumber">N√∫mero de Membres√≠a <span class="required">*</span></label>
                     <input type="text" id="wheelMembershipNumber" placeholder="Ingresa tu n√∫mero de membres√≠a">
                  </div>
                  <button class="btn" onclick="startWheel()">Empezar a Jugar</button>
                  <div class="loading" id="wheelLoginLoading">
                     <div class="spinner"></div>
                     <p>Verificando membres√≠a...</p>
                  </div>
                  <div class="message" id="wheelLoginMessage"></div>
               </div>
               <!-- Juego de la Ruleta -->
               <div class="wheel-game" id="wheelGame">
                  <div class="wheel-wrapper">
                     <div class="wheel-pointer"></div>
                     <div class="wheel" id="wheel">
                        <!-- Segmentos generados din√°micamente -->
                     </div>
                     <div class="wheel-center"></div>
                  </div>
                  <button class="spin-button" id="spinButton" onclick="spinWheel()">
                  üé∞ GIRAR RULETA
                  </button>
                  <div class="wheel-result" id="wheelResult">
                     <h3>üéâ ¬°Felicidades!</h3>
                     <p id="wheelPrize">Has ganado: <strong>500 Puntos</strong></p>
                  </div>
                  <button class="btn btn-secondary" style="margin-top: 20px;" onclick="resetWheel()">
                  Jugar de Nuevo
                  </button>
               </div>
            </div>
         </section>
         <!-- SECCI√ìN CONSULTAR PERFIL -->
         <section id="perfil" class="section">
            <h1>Consultar Perfil de Miembro</h1>
            <p class="subtitle">Busca por n√∫mero de membres√≠a</p>
            <div class="profile-search">
               <input type="text" id="searchInput" placeholder="Ingresa tu n√∫mero de membres√≠a">
               <button class="btn" onclick="searchProfile()">Buscar</button>
            </div>
            <div class="loading" id="loadingProfile">
               <div class="spinner"></div>
               <p>Buscando perfil...</p>
            </div>
            <div class="message" id="profileMessage"></div>
            <div class="profile-card" id="profileCard">
               <div class="profile-header">
                  <div class="profile-avatar" id="profileAvatar">JD</div>
                  <div class="profile-name">
                     <h2 id="profileName">John Doe</h2>
                     <span class="profile-tier" id="profileTier">Gold Member</span>
                  </div>
               </div>
               <div class="profile-stats">
                  <div class="stat-card">
                     <div class="stat-value" id="totalPoints">25,450</div>
                     <div class="stat-label">Puntos Totales</div>
                  </div>
                  <div class="stat-card">
                     <div class="stat-value" id="availablePoints">18,200</div>
                     <div class="stat-label">Puntos Disponibles</div>
                  </div>
                  <div class="stat-card">
                     <div class="stat-value" id="tierPoints">7,250</div>
                     <div class="stat-label">Puntos de Nivel</div>
                  </div>
                  <div class="stat-card">
                     <div class="stat-value" id="memberSince">2 a√±os</div>
                     <div class="stat-label">Miembro desde</div>
                  </div>
               </div>
               <h3 style="margin-bottom: 20px; color: #333;">Informaci√≥n Personal</h3>
               <div class="profile-details">
                  <div class="detail-item">
                     <div class="detail-label">Email</div>
                     <div class="detail-value" id="profileEmail">john.doe@email.com</div>
                  </div>
                  <div class="detail-item">
                     <div class="detail-label">Tel√©fono</div>
                     <div class="detail-value" id="profilePhone">+34 600 123 456</div>
                  </div>
                  <div class="detail-item">
                     <div class="detail-label">N√∫mero de Membres√≠a</div>
                     <div class="detail-value" id="profileMembership">LM123456789</div>
                  </div>
                  <div class="detail-item">
                     <div class="detail-label">Canal de Registro</div>
                     <div class="detail-value" id="profileChannel">Web</div>
                  </div>
                  <div class="detail-item">
                     <div class="detail-label">Fecha de Registro</div>
                     <div class="detail-value" id="profileEnrollmentDate">15/01/2023</div>
                  </div>
                  <div class="detail-item">
                     <div class="detail-label">Estado</div>
                     <div class="detail-value" id="profileStatus">Activo</div>
                  </div>
               </div>
            </div>
         </section>
      </div>
      <script>
    // ============================================
    // CONFIGURACI√ìN (DECLARAR PRIMERO)
    // ============================================
    const WORKER_URL = 'https://young-snowflake-1f82.williamriveragr.workers.dev';
    const PROGRAM_ID = '0lpd20000001aO1AAI';
    
    // Estado del juego
    let currentMember = null;
    let isSpinning = false;
    
    // Premios de la ruleta (se cargar√°n din√°micamente)
    let wheelPrizes = [];
    
    // ============================================
    // REFERENCIAS AL DOM (DECLARAR AL INICIO)
    // ============================================
    const form = document.getElementById('loyaltyForm');
    const submitBtn = document.getElementById('submitBtn');
    const loading = document.getElementById('loading');
    const messageDiv = document.getElementById('message');
    
    // Referencias para la ruleta
    const wheelLoginDiv = document.getElementById('wheelLogin');
    const wheelGameDiv = document.getElementById('wheelGame');
    const wheelMembershipInput = document.getElementById('wheelMembershipNumber');
    const loginLoading = document.getElementById('wheelLoginLoading');
    const loginMessage = document.getElementById('wheelLoginMessage');
    const spinButton = document.getElementById('spinButton');
    const wheelElement = document.getElementById('wheel');
    const resultDiv = document.getElementById('wheelResult');
    const wheelPrizeText = document.getElementById('wheelPrize');

    // ============================================
    // NAVEGACI√ìN
    // ============================================
    function showSection(sectionId) {
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        
        document.getElementById(sectionId).classList.add('active');
        
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
            if (link.dataset.section === sectionId) {
                link.classList.add('active');
            }
        });
        
        document.getElementById('navMenu').classList.remove('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    document.getElementById('navToggle').addEventListener('click', () => {
        document.getElementById('navMenu').classList.toggle('active');
    });

    // ============================================
    // FORMULARIO DE REGISTRO
    // ============================================
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (!form.checkValidity()) {
            showMessage('Por favor, complete todos los campos requeridos', 'error');
            return;
        }

        const membershipNumber = generateMembershipNumber();
        
        const formData = {
            firstName: document.getElementById('firstName').value.trim(),
            lastName: document.getElementById('lastName').value.trim(),
            email: document.getElementById('email').value.trim(),
            phone: document.getElementById('phone').value.trim(),
            birthDate: document.getElementById('birthDate').value,
            programId: PROGRAM_ID,
            enrollmentChannel: document.getElementById('enrollmentChannel').value
        };

        document.getElementById('membershipNumber').value = membershipNumber;
        
        submitBtn.disabled = true;
        loading.classList.add('show');
        messageDiv.classList.remove('show');

        try {
            const response = await fetch(WORKER_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    operation: "createMember",
                    data: formData
                })
            });

            const result = await response.json();
            
            if (result.success) {
                showMessage(`¬°Registro exitoso! N√∫mero de membres√≠a: ${result.data.membershipNumber}`, 'success');
                
                setTimeout(() => {
                    form.reset();
                    showSection('home');
                }, 3000);
            } else {
                showMessage('Error al registrar: ' + result.error, 'error');
            }
            
        } catch (error) {
            console.error('Error:', error);
            showMessage('Error al registrar: ' + error.message, 'error');
        } finally {
            submitBtn.disabled = false;
            loading.classList.remove('show');
        }
    });

    // ============================================
    // B√öSQUEDA DE PERFIL
    // ============================================
    async function searchProfile() {
        const searchInput = document.getElementById('searchInput').value.trim();
        const loadingProfile = document.getElementById('loadingProfile');
        const profileMessage = document.getElementById('profileMessage');
        const profileCard = document.getElementById('profileCard');
        
        if (!searchInput) {
            showProfileMessage('Por favor, ingresa un n√∫mero de membres√≠a', 'error');
            return;
        }
        
        loadingProfile.classList.add('show');
        profileMessage.classList.remove('show');
        profileCard.classList.remove('show');
        
        try {
            const response = await fetch(WORKER_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    operation: "getMember",
                    data: { membershipNumber: searchInput }
                })
            });

            const result = await response.json();
            
            if (!result.success) {
                showProfileMessage(result.error || 'Perfil no encontrado.', 'error');
                return;
            }
            
            displayProfile(result.data);
            profileCard.classList.add('show');
            
        } catch (error) {
            console.error('Error:', error);
            showProfileMessage('Error al buscar perfil.', 'error');
        } finally {
            loadingProfile.classList.remove('show');
        }
    }

    function displayProfile(profile) {
        const initials = (profile.contact.firstName.charAt(0) + profile.contact.lastName.charAt(0)).toUpperCase();
        document.getElementById('profileAvatar').textContent = initials;
        document.getElementById('profileName').textContent = `${profile.contact.firstName} ${profile.contact.lastName}`;
        document.getElementById('profileTier').textContent = profile.tier;
        document.getElementById('totalPoints').textContent = profile.points.total.toLocaleString();
        document.getElementById('memberSince').textContent = profile.memberSince;
        document.getElementById('profileEmail').textContent = profile.contact.email;
        document.getElementById('profilePhone').textContent = profile.contact.phone;
        document.getElementById('profileMembership').textContent = profile.membershipNumber;
        document.getElementById('profileChannel').textContent = profile.enrollmentChannel;
        
        const enrollmentDate = new Date(profile.enrollmentDate);
        document.getElementById('profileEnrollmentDate').textContent = enrollmentDate.toLocaleDateString('es-ES');
        document.getElementById('profileStatus').textContent = profile.status === 'Active' ? 'Activo' : profile.status;
        
        displayCurrencies(profile.points.currencies);
    }

    function displayCurrencies(currencies) {
        const profileStats = document.querySelector('.profile-stats');
        const existingCurrencyCards = profileStats.querySelectorAll('.currency-card');
        existingCurrencyCards.forEach(card => card.remove());
        
        const availableCard = document.getElementById('availablePoints')?.closest('.stat-card');
        const tierCard = document.getElementById('tierPoints')?.closest('.stat-card');
        if (availableCard) availableCard.remove();
        if (tierCard) tierCard.remove();
        
        currencies.forEach((currency, index) => {
            const card = document.createElement('div');
            card.className = 'stat-card currency-card';
            card.style.animationDelay = `${index * 0.1}s`;
            card.innerHTML = `
                <div class="stat-value">${currency.balance.toLocaleString()}</div>
                <div class="stat-label">${currency.name}</div>
            `;
            
            const memberSinceCard = document.getElementById('memberSince').closest('.stat-card');
            profileStats.insertBefore(card, memberSinceCard);
        });
    }

    // ============================================
    // SPIN THE WHEEL
    // ============================================
    function initWheel() {
        wheelElement.innerHTML = ''; // Limpiar ruleta
        const segmentAngle = 360 / wheelPrizes.length;
        
        wheelPrizes.forEach((prize, index) => {
            const segment = document.createElement('div');
            segment.className = 'wheel-segment';
            segment.style.transform = `rotate(${index * segmentAngle}deg)`;
            segment.style.background = prize.color;
            
            const label = document.createElement('span');
            label.textContent = prize.name;
            segment.appendChild(label);
            
            wheelElement.appendChild(segment);
        });
    }

    async function loadGamePrizes(gameName) {
        try {
            const response = await fetch(WORKER_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    operation: "getGames",
                    data: { gameName: gameName }
                })
            });

            const result = await response.json();
            
            if (result.success) {
                wheelPrizes = result.data.prizes.map(prize => ({
                    id: prize.id,
                    name: prize.name,
                    value: prize.value,
                    color: prize.color,
                    rewardType: prize.rewardType,
                    rewardDefinitionId: prize.rewardDefinitionId,
                    winProbability: prize.winProbability,
                    isAvailable: prize.isAvailable
                }));
                
                console.log('Premios cargados:', wheelPrizes);
                return true;
            } else {
                console.error('Error cargando premios:', result.error);
                return false;
            }
            
        } catch (error) {
            console.error('Error:', error);
            return false;
        }
    }

    async function startWheel() {
        const membershipNumber = wheelMembershipInput.value.trim();
        
        if (!membershipNumber) {
            showWheelLoginMessage('Por favor, ingresa tu n√∫mero de membres√≠a', 'error');
            return;
        }
        
        loginLoading.classList.add('show');
        loginMessage.classList.remove('show');
        
        // Cargar premios del juego
        const prizesLoaded = await loadGamePrizes('Super Spin Rewards');
        
        if (!prizesLoaded) {
            showWheelLoginMessage('Error al cargar los premios del juego', 'error');
            loginLoading.classList.remove('show');
            return;
        }
        
        // Verificar miembro
        try {
            const response = await fetch(WORKER_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    operation: "getMember",
                    data: { membershipNumber }
                })
            });

            const result = await response.json();
            
            if (result.success) {
                currentMember = result.data;
                wheelLoginDiv.style.display = 'none';
                wheelGameDiv.classList.add('active');
                initWheel();
            } else {
                showWheelLoginMessage('Miembro no encontrado. Verifica tu n√∫mero.', 'error');
            }
        } catch (error) {
            console.error('Error:', error);
            showWheelLoginMessage('Error al verificar membres√≠a.', 'error');
        } finally {
            loginLoading.classList.remove('show');
        }
    }

async function spinWheel() {
    if (isSpinning || wheelPrizes.length === 0) return;
    
    isSpinning = true;
    spinButton.disabled = true;
    resultDiv.classList.remove('show');
    
    // Seleccionar premio basado en probabilidades
    const selectedPrize = selectPrizeByProbability();
    const prizeIndex = wheelPrizes.findIndex(p => p.id === selectedPrize.id);
    
    const segmentAngle = 360 / wheelPrizes.length;
    const targetAngle = (360 - (prizeIndex * segmentAngle)) + (segmentAngle / 2);
    const totalRotation = 360 * 5 + targetAngle; // 5 vueltas completas + √°ngulo objetivo
    
    wheelElement.style.transform = `rotate(${totalRotation}deg)`;
    
    setTimeout(async () => {
        wheelPrizeText.innerHTML = `Has ganado: <strong>${selectedPrize.name}</strong>`;
        resultDiv.classList.add('show');
        
        // Si gan√≥ puntos, acreditar
        if (selectedPrize.rewardType === 'LoyaltyPoints' && selectedPrize.value > 0) {
            try {
                const transactionResult = await createTransaction(
                    currentMember.memberId, 
                    selectedPrize.value, 
                    selectedPrize.name,
                    selectedPrize.rewardDefinitionId
                );
                
                if (transactionResult.success) {
                    console.log('Puntos acreditados exitosamente');
                } else {
                    console.error('Error al acreditar puntos:', transactionResult.error);
                }
            } catch (error) {
                console.error('Error al acreditar puntos:', error);
            }
        }
        
        // Si gan√≥ un voucher, crear voucher
        if (selectedPrize.rewardType === 'Voucher' && selectedPrize.rewardDefinitionId) {
            try {
                const voucherResult = await createVoucher(
                    currentMember.memberId,
                    selectedPrize.rewardDefinitionId,
                    selectedPrize.name
                );
                
                if (voucherResult.success) {
                    wheelPrizeText.innerHTML += `<br><small>C√≥digo: ${voucherResult.data.voucherCode}</small>`;
                    console.log('Voucher creado exitosamente');
                } else {
                    console.error('Error al crear voucher:', voucherResult.error);
                }
            } catch (error) {
                console.error('Error al crear voucher:', error);
            }
        }
        
        isSpinning = false;
        spinButton.disabled = false;
    }, 4000);
}

// ============================================
// FUNCI√ìN: SELECCIONAR PREMIO POR PROBABILIDAD
// ============================================
function selectPrizeByProbability() {
    // Filtrar solo premios disponibles
    const availablePrizes = wheelPrizes.filter(prize => prize.isAvailable);
    
    if (availablePrizes.length === 0) {
        // Si no hay premios disponibles, devolver "Mejor Suerte"
        return wheelPrizes.find(p => p.rewardType === 'NoReward') || wheelPrizes[0];
    }
    
    // Calcular probabilidad total
    const totalProbability = availablePrizes.reduce((sum, prize) => sum + prize.winProbability, 0);
    
    // Generar n√∫mero aleatorio entre 0 y la probabilidad total
    let random = Math.random() * totalProbability;
    
    // Seleccionar premio seg√∫n probabilidad acumulada
    let cumulativeProbability = 0;
    
    for (const prize of availablePrizes) {
        cumulativeProbability += prize.winProbability;
        
        if (random <= cumulativeProbability) {
            return prize;
        }
    }
    
    // Fallback: devolver el √∫ltimo premio disponible
    return availablePrizes[availablePrizes.length - 1];
}

// ============================================
// API CALL: CREAR TRANSACCI√ìN (ACTUALIZADA)
// ============================================
async function createTransaction(memberId, amount, productName, rewardDefinitionId) {
    const response = await fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            operation: "createTransaction",
            data: {
                memberId: memberId,
                amount: amount,
                transactionType: "Accrual",
                journalType: "Accrual",
                journalSubType: "Gamification",
                productName: productName,
                rewardDefinitionId: rewardDefinitionId // ID del Reward Definition
            }
        })
    });
    return await response.json();
}

// ============================================
// API CALL: CREAR VOUCHER (NUEVO)
// ============================================
async function createVoucher(memberId, voucherDefinitionId, voucherName) {
    const response = await fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            operation: "createVoucher",
            data: {
                memberId: memberId,
                voucherDefinitionId: voucherDefinitionId,
                voucherName: voucherName
            }
        })
    });
    return await response.json();
}

    function resetWheel() {
        wheelGameDiv.classList.remove('active');
        wheelLoginDiv.style.display = 'block';
        wheelMembershipInput.value = '';
        resultDiv.classList.remove('show');
        wheelElement.style.transform = 'rotate(0deg)';
        wheelElement.innerHTML = '';
        currentMember = null;
        wheelPrizes = [];
    }

// ============================================
// COMPRA DE PRODUCTOS
// ============================================
async function buyProduct(productName, points) {
    // Verificar si el usuario est√° logueado (tiene membres√≠a)
    const membershipNumber = prompt('Ingresa tu n√∫mero de membres√≠a para canjear:');
    
    if (!membershipNumber) {
        alert('Debes ingresar tu n√∫mero de membres√≠a');
        return;
    }
    
    if (!confirm(`¬øDeseas canjear ${points.toLocaleString()} puntos por ${productName}?`)) {
        return;
    }
    
    // Mostrar loading
    const loadingMessage = document.createElement('div');
    loadingMessage.className = 'loading show';
    loadingMessage.innerHTML = '<div class="spinner"></div><p>Procesando canje...</p>';
    document.querySelector('#comprar').appendChild(loadingMessage);
    
    try {
        // Obtener datos del miembro
        const memberResponse = await fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                operation: "getMember",
                data: { membershipNumber: membershipNumber }
            })
        });
        
        const memberResult = await memberResponse.json();
        
        if (!memberResult.success) {
            alert('Miembro no encontrado. Verifica tu n√∫mero de membres√≠a.');
            return;
        }
        
        // Verificar si tiene puntos suficientes
        if (memberResult.data.points.total < points) {
            alert(`No tienes suficientes puntos. Necesitas ${points.toLocaleString()} puntos pero solo tienes ${memberResult.data.points.total.toLocaleString()}.`);
            return;
        }
        
        // Crear transacci√≥n de redenci√≥n (redenci√≥n = puntos negativos)
        const transactionResult = await createRedemptionTransaction(
            memberResult.data.memberId,
            points, 
            productName
        );
        
        if (transactionResult.success) {
            alert(`¬°Producto canjeado exitosamente!\n\nProducto: ${productName}\nPuntos utilizados: ${points.toLocaleString()}\nTransacci√≥n: ${transactionResult.data.transactionNumber}`);
            
            // Opcional: redirigir a perfil para ver puntos actualizados
            showSection('perfil');
        } else {
            alert('Error al canjear producto: ' + transactionResult.error);
        }
        
    } catch (error) {
        console.error('Error:', error);
        alert('Error al procesar el canje. Intenta nuevamente.');
    } finally {
        // Remover loading
        loadingMessage.remove();
    }
}

// ============================================
// API CALL: CREAR TRANSACCI√ìN DE REDENCI√ìN
// ============================================
async function createRedemptionTransaction(memberId, amount, productName) {
    const response = await fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            operation: "createTransaction",
            data: {
                memberId: memberId,
                amount: amount, // Negativo para redenci√≥n
                journalSubType: "Product", // Tipo de redenci√≥n
                productName: productName,
                activityDate: new Date().toISOString().split('T')[0]
            }
        })
    });
    return await response.json();
}

// ============================================
// API CALL: CREAR TRANSACCI√ìN DE ACUMULACI√ìN (Ya existente, actualizada)
// ============================================
async function createAccrualTransaction(memberId, amount, productName, rewardDefinitionId) {
    const response = await fetch(WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            operation: "createTransaction",
            data: {
                memberId: memberId,
                amount: amount,
                journalSubType: "Gamification", // Tipo de acumulaci√≥n
                productName: productName,
                rewardDefinitionId: rewardDefinitionId,
                activityDate: new Date().toISOString().split('T')[0]
            }
        })
    });
    return await response.json();
}

    // ============================================
    // FUNCIONES AUXILIARES
    // ============================================
    function generateMembershipNumber() {
        const prefix = 'LM';
        const timestamp = Date.now().toString().slice(-8);
        const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
        return `${prefix}${timestamp}${random}`;
    }
    
    function showMessage(text, type) {
        messageDiv.textContent = text;
        messageDiv.className = `message ${type} show`;
    }
    
    function showProfileMessage(text, type) {
        const profileMessage = document.getElementById('profileMessage');
        profileMessage.textContent = text;
        profileMessage.className = `message ${type} show`;
    }

    function showWheelLoginMessage(text, type) {
        loginMessage.textContent = text;
        loginMessage.className = `message ${type} show`;
    }
      </script>
   </body>
</html>
